<div id="density"></div>

<div id="vector-phi1">\( \phi_1 \)</div>
<div id="vector-phi2">\( \phi_2 \)</div>
<div id="vector-phi3">\( \phi_3 \)</div>

<script>
    import * as d3 from 'd3';
    import { onMount } from 'svelte';
    import * as tf from '@tensorflow/tfjs'
    import { CoordinateConversions } from './util/CoordinateConversions.js'
    import { VectorGroup } from './util/VectorGroup.js'
    import { ContourPlot } from './util/ContourPlot.js'

    import { loss_4 as loss_1 } from './util/loss';

    const margin = { top: 20, right: 30, bottom: 30, left: 40 }
    const width = 600, height = 400
    const xrange = [0, 1], yrange = [0, 1]

    onMount(() => {
        var svg = d3.select('#density').append('svg')
            .attr("width", width)
            .attr("height", height)
            .append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")")

        var coordinateConversions = new CoordinateConversions(svg, margin, width, height, xrange, yrange)


        var contour = new ContourPlot(loss_1, svg, coordinateConversions)
        contour.render()

        var defaultVectors = [
            { id: "vector-phi1", x: .7, y: .5 },
            { id: "vector-phi2", x: .3, y: .5 },
            { id: "vector-phi3", x: .6, y: .4 }
        ]

        var vectorGroup = new VectorGroup(svg, { x: .5, y: .5 }, defaultVectors, coordinateConversions)

        vectorGroup.declare().animate()

        coordinateConversions.displayAxes()
    })
</script>