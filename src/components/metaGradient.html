
<div>
    {#each tasks as task, i}
      <input type="radio" bind:group={selected_task} value={i} id={`loss_${i+1}`}>
      <label for={`loss_${i+1}`}>
        \( \mathcal L_{i+1} \)
      </label>
    {/each}
</div>


<Chart width=600 height=400>
  <defs>
    <marker id="arrowhead" fill="#fff" markerWidth="10" markerHeight="10" refX="8.7" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" />
    </marker>
  </defs>
  <Axis>
    {#each tasks as task, i}
      <ContourPlot lossFunc={task.loss} logScale=true opacity={i == selected_task ? 1 : 0} />
    {/each}

    {#each tasks as task, i}
      <ContourPlot lossFunc={task.loss} logScale=true opacity={i == selected_task ? 1 : 0} />
    {/each}

    {#each tasks as task, i}
      <Line origin={theta} target={task.phi}
            stroke="#fff" fill="#fff" stroke-width="1" marker-end="url(#arrowhead)" />
    {/each}

    <VariableHandle bind:position={theta} value="\theta" />

    {#each tasks as task, i}
      <VariableHandle bind:position={task.phi} value="\phi_{i}" />
    {/each}
  </Axis>
</Chart>


<script>
    import Chart from './chart.html'
    import ContourPlot from './contourPlot.html'
    import Axis from './axis.html'
    import Line from './line.html'
    import VariableHandle from './variableHandle.html'


    import * as d3 from 'd3';
    import { onMount, getContext } from 'svelte';
    import * as tf from '@tensorflow/tfjs'

    import { loss_4 as loss_1 } from './util/loss'
    import { loss_3 as loss_2 } from './util/loss'

    let tasks = [
      {loss: loss_1, phi: [0.1, 0.2]},
      {loss: loss_2, phi: [0.3, 0.8]}
    ]

    let theta = [0.5, 0.5]

    let selected_task = 0
</script>
